FROM python:3.13-slim-bullseye

ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

WORKDIR /app

# ØªØ«Ø¨ÙŠØª Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… (Ø¨Ù…Ø§ ÙÙŠÙ‡Ø§ netcat Ù„Ù„Ø§Ù†ØªØ¸Ø§Ø±)
RUN apt-get update \
  && apt-get install -y build-essential libpq-dev gettext netcat-openbsd \
  && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false \
  && rm -rf /var/lib/apt/lists/*

RUN pip install --upgrade pip  

# ØªØ«Ø¨ÙŠØª Ù…ÙƒØªØ¨Ø§Øª Ø¨Ø§ÙŠØ«ÙˆÙ†
COPY ./requirements.txt /requirements.txt
RUN pip install -r /requirements.txt

# ğŸ›‘ğŸ›‘ Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø§Ø³Ù…Ø©: Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¥Ù„Ù‰ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ø§ÙˆÙŠØ© ğŸ›‘ğŸ›‘
COPY . /app

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø³ÙƒØ±Ø¨ØªØ§Øª Ø§Ù„ØªØ´ØºÙŠÙ„
COPY ./docker/local/django/entrypoint.sh /entrypoint.sh
RUN sed -i 's/\r$//g' /entrypoint.sh
RUN chmod +x /entrypoint.sh

COPY ./docker/local/django/start.sh /start.sh
RUN sed -i 's/\r$//g' /start.sh
RUN chmod +x /start.sh

ENTRYPOINT ["/entrypoint.sh"]