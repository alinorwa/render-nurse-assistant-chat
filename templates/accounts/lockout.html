{% extends 'base.html' %} {% block title %}The account has been temporarily suspended.{% endblock %}
{% block content %}
<div
  class="card"
  style="text-align: center; border-top: 5px solid #dc3545; padding-top: 40px"
>
  <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚ÙÙ„ -->
  <div style="margin-bottom: 10px">
    <span style="font-size: 4rem">ğŸ”’</span>
  </div>

  <h2 style="color: #dc3545; margin-bottom: 10px">Sorry, the account has been locked.</h2>

  <p style="font-size: 1.1em; color: #555; margin-bottom: 30px">
    Login attempts have been exhausted. For protection, please wait a moment.
  </p>

  <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒØ¨ÙŠØ± -->
  <div
    style="
      background-color: #f8f9fa;
      border: 2px dashed #dc3545;
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
    "
  >
    <div style="font-size: 0.9em; color: #777; margin-bottom: 5px">
      You can try again within
    </div>

    <!-- Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø±Ù‚Ù…ÙŠ -->
    <div
      id="countdown"
      style="
        font-size: 3.5rem;
        font-weight: bold;
        color: #dc3545;
        font-family: monospace;
      "
    >
      60:00
    </div>

    <div
      id="redirect-msg"
      style="font-size: 0.9em; color: #28a745; display: none"
    >
    You are being redirected to the login page...
    </div>
  </div>

  <hr />

  <h3 style="margin-top: 20px"> An emergency situation?</h3>
  <p>Don't wait until time runs out if you need immediate help.</p>

  <div style="margin-top: 20px">
    <!-- Ø²Ø± ÙˆÙ‡Ù…ÙŠ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© (ÙŠØ³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†ÙØ³ÙŠ) -->
    <button
      onclick="window.location.reload()"
      class="btn-primary"
      style="background-color: #6c757d; width: auto; margin: 5px"
    >
       Time update
    </button>

    <a
      href="#"
      class="btn-primary"
      style="
        background-color: #dc3545;
        display: inline-block;
        width: auto;
        text-decoration: none;
        margin: 5px;
      "
    >
      ğŸš‘   Request for immediate assistance
    </a>
  </div>
</div>

<script>
  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆÙ‚Øª (Ø¨Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©) - ÙŠØ¬Ø¨ Ø£Ù† ØªØ·Ø§Ø¨Ù‚ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª AXES_COOLOFF_TIME
  const LOCKOUT_MINUTES = 1;

  function startTimer() {
    const timerDisplay = document.getElementById("countdown");
    const msgDisplay = document.getElementById("redirect-msg");

    // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ: Ù‡Ù„ ÙŠÙˆØ¬Ø¯ ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ø®Ø²Ù† Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŸ
    let endTime = localStorage.getItem("axes_lockout_end");

    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ ÙˆÙ‚Øª Ù…Ø®Ø²Ù† (Ø£ÙˆÙ„ Ù…Ø±Ø© ØªÙØªØ­ Ø§Ù„ØµÙØ­Ø©)ØŒ Ù†Ø¶Ø¹ ÙˆÙ‚ØªØ§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹
    if (!endTime) {
      const now = new Date().getTime();
      endTime = now + LOCKOUT_MINUTES * 60 * 1000;
      localStorage.setItem("axes_lockout_end", endTime);
    }

    // 2. Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
    const interval = setInterval(function () {
      const now = new Date().getTime();
      const distance = endTime - now;

      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚ ÙˆØ§Ù„Ø«ÙˆØ§Ù†ÙŠ
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);

      // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª (Ø¥Ø¶Ø§ÙØ© ØµÙØ± Ù„Ù„ÙŠØ³Ø§Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† Ø±Ù‚Ù…Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹)
      timerDisplay.innerHTML =
        (minutes < 10 ? "0" + minutes : minutes) +
        ":" +
        (seconds < 10 ? "0" + seconds : seconds);

      // 3. Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª
      if (distance < 0) {
        clearInterval(interval);
        timerDisplay.innerHTML = "00:00";
        timerDisplay.style.color = "#28a745"; // ÙŠØªØ­ÙˆÙ„ Ù„Ù„Ø£Ø®Ø¶Ø±
        msgDisplay.style.display = "block";

        // ØªÙ†Ø¸ÙŠÙ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
        localStorage.removeItem("axes_lockout_end");

        // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
        setTimeout(() => {
          window.location.href = "{% url 'login' %}";
        }, 2000); // Ù†Ù†ØªØ¸Ø± Ø«Ø§Ù†ÙŠØªÙŠÙ† Ù„ÙŠÙ‚Ø±Ø£ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
      }
    }, 1000);
  }

  // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  startTimer();
</script>
{% endblock %}
